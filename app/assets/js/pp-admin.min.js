/*! PesaPress Free - v2.3
 * https://alloy.co.ke/projects/pesapress
 * Copyright (c) 2021; * Licensed GPLv2+ */

window.pesapress=window.pesapress||{},pesapress.helper={notification:{show:function(e,s){jQuery(".pesapress-message").html('<a class="uk-alert-close" uk-close></a>'+e).addClass("uk-alert-"+s).removeClass("uk-invisible")},reset:function(){jQuery(".pesapress-message").html("").removeClass("uk-alert-success").removeClass("uk-alert-warning").removeClass("uk-alert-danger").addClass("uk-invisible")}},loader:function(e,s){jQuery("<div class='"+e+"'><img src='"+pesapress.assets.spinner+"' class='pesapress-spinner-center'/></div>").css({position:"absolute",width:"100%",height:"100%",top:0,left:0,background:"#ecebea",textAlign:"center"}).appendTo(s.css("position","relative"))},slider:function(e){var a=jQuery(e).attr("data-id"),s=jQuery(e).attr("data-max"),t=jQuery("input[name="+a+"]");jQuery(e).slider({min:0,max:s,value:t.val(),slide:function(e,s){jQuery("."+a).html(s.value),t.val(s.value)}})}},jQuery(function(p){p("body").on("click",".pesapress-modal",function(e){var t=p(this),s=t.attr("data-nonce"),a=t.attr("data-action"),o=t.attr("title"),r=p(".object-details"),i=p(".object-details .uk-modal-title"),n=p(".object-details .uk-modal-body");pesapress.helper.notification.reset(),t.html('<img src="'+pesapress.assets.spinner+'"/>'),p.post(window.ajaxurl,{_wpnonce:s,action:a}).done(function(e){t.html(o),!0===e.success?(i.html(e.data.title),n.html(e.data.html),UIkit.modal(r).show()):pesapress.helper.notification.show(e.data,"warning")}).fail(function(e,s,a){t.html(o),pesapress.helper.notification.show(pesapress.loading.error,"danger")})}),p("body").on("click",".pesapress-edit-modal",function(e){var s=p(this),a=s.attr("data-nonce"),t=s.attr("data-action"),o=(s.attr("title"),s.attr("data-id")),r=p(".object-details"),i=p(".object-details .uk-modal-title"),n=p(".object-details .uk-modal-body"),l="pesapress-setup-loader",s=p(".pesapress-gateway-list");pesapress.helper.loader(l,s),p.post(window.ajaxurl,{_wpnonce:a,action:t,id:o}).done(function(e){p("."+l).remove(),!0===e.success?(i.html(e.data.title),n.html(e.data.html),UIkit.modal(r).show()):pesapress.helper.notification.show(e.data,"warning")}).fail(function(e,s,a){p("."+l).remove(),pesapress.helper.notification.show(pesapress.loading.error,"danger")})}),p("body").on("click",".pesapress-view-modal",function(e){var s=p(this),a=s.attr("data-nonce"),t=s.attr("data-action"),o=(s.attr("title"),s.attr("data-id")),r=p(".object-details"),i=p(".object-details .uk-modal-title"),n=p(".object-details .uk-modal-body"),l="pesapress-setup-loader",s=p(".pesapress-logs-list");pesapress.helper.loader(l,s),p.post(window.ajaxurl,{_wpnonce:a,action:t,id:o}).done(function(e){p("."+l).remove(),!0===e.success?(i.html(e.data.title),n.html(e.data.html),UIkit.modal(r).show()):pesapress.helper.notification.show(e.data,"warning")}).fail(function(e,s,a){p("."+l).remove(),pesapress.helper.notification.show(pesapress.loading.error,"danger")})})}),jQuery(function(n){n("body").on("change",".pesapress-load-setup-select",function(e){var s=n(this),a=s.val(),t=s.attr("data-nonce"),o=s.attr("data-action"),r=n(".pesapress-setup-form-details"),i="pesapress-setup-loader",s=n(".create-gateway-form");"0"!==a?(pesapress.helper.loader(i,s),n.post(window.ajaxurl,{_wpnonce:t,action:o,gateway:a}).done(function(e){n("."+i).remove(),!0===e.success?r.html(e.data):r.html(pesapress.loading.error)}).fail(function(e,s,a){n("."+i).remove(),r.html(pesapress.loading.error)})):r.html("")}),n("body").on("submit",".create-gateway-form",function(e){var s=n(this),t=s.find("button"),o="pesapress-setup-loader";return pesapress.helper.loader(o,s),t.attr("disabled","disabled"),n.post(window.ajaxurl,s.serialize()).done(function(e){t.removeAttr("disabled"),n("."+o).remove(),!0===e.success?(pesapress.helper.notification.show(e.data.message,"success"),window.setTimeout(function(){window.location.href=e.data.url},1e3)):pesapress.helper.notification.show(e.data,"warning")}).fail(function(e,s,a){n("."+o).remove(),t.removeAttr("disabled"),pesapress.helper.notification.show(pesapress.error,"danger")}),!1}),n("body").on("click",".clone-gateway",function(e){var s=n(this),a=(s.attr("title"),s.attr("data-nonce")),t=s.attr("data-action"),o=s.attr("data-id"),r="pesapress-setup-loader",s=n(".pesapress-gateway-list");pesapress.helper.loader(r,s),n.post(window.ajaxurl,{_wpnonce:a,action:t,id:o}).done(function(e){n("."+r).remove(),!0===e.success&&window.setTimeout(function(){window.location.href=e.data.url},100)}).fail(function(e,s,a){n("."+r).remove()})}),n("body").on("click",".delete-gateway",function(e){var s=n(this),a=(s.attr("title"),s.attr("data-nonce")),t=s.attr("data-action"),o=s.attr("data-id"),r="pesapress-setup-loader",s=n(".pesapress-gateway-list");pesapress.helper.loader(r,s),n.post(window.ajaxurl,{_wpnonce:a,action:t,id:o}).done(function(e){n("."+r).remove(),!0===e.success&&window.setTimeout(function(){window.location.href=e.data.url},100)}).fail(function(e,s,a){n("."+r).remove()})}),n("body").on("click",".pesapress-select-all",function(e){n('.pesapress-gateway-list tbody input[type="checkbox"]').prop("checked",this.checked);var s=n(".pesapress-gateway-list tbody input:checked").map(function(){if(parseFloat(this.value))return this.value}).get().join(",");n('form[name="bulk-action-form"] input[name="ids"]').val(s)}),n("body").on("click",".pesapress-single-check",function(e){var s=n(".pesapress-gateway-list tbody input:checked").map(function(){if(parseFloat(this.value))return this.value}).get().join(",");n('form[name="bulk-action-form"] input[name="ids"]').val(s)}),n("body").on("submit",".bulk-action-form",function(e){var s=n(this),t=s.find("button"),o="pesapress-setup-loader";return pesapress.helper.loader(o,n(".pesapress-gateway-list")),t.attr("disabled","disabled"),n.post(window.ajaxurl,s.serialize()).done(function(e){t.removeAttr("disabled"),n("."+o).remove(),!0===e.success?window.location.href=e.data.url:pesapress.helper.notification.show(e.data,"warning")}).fail(function(e,s,a){n("."+o).remove(),t.removeAttr("disabled"),pesapress.helper.notification.show(pesapress.error,"danger")}),!1})}),jQuery(function(i){i("body").on("click",".pesapress-log-select-all",function(e){i('.pesapress-logs-list tbody input[type="checkbox"]').prop("checked",this.checked);var s=i(".pesapress-logs-list tbody input:checked").map(function(){if(parseFloat(this.value))return this.value}).get().join(",");i('form[name="bulk-logs-form"] input[name="ids"]').val(s),i('form[name="export-logs-form"] input[name="ids"]').val(s)}),i("body").on("click",".pesapress-log-single-check",function(e){var s=i(".pesapress-logs-list tbody input:checked").map(function(){if(parseFloat(this.value))return this.value}).get().join(",");i('form[name="bulk-logs-form"] input[name="ids"]').val(s),i('form[name="export-logs-form"] input[name="ids"]').val(s)}),i("body").on("click",".delete-log",function(e){var s=i(this),a=(s.attr("title"),s.attr("data-nonce")),t=s.attr("data-action"),o=s.attr("data-id"),r="pesapress-setup-loader",s=i(".pesapress-logs-list");pesapress.helper.loader(r,s),i.post(window.ajaxurl,{_wpnonce:a,action:t,id:o}).done(function(e){i("."+r).remove(),!0===e.success&&window.setTimeout(function(){window.location.href=e.data.url},100)}).fail(function(e,s,a){i("."+r).remove()})}),i("body").on("submit",".bulk-logs-form, .filter-logs-form",function(e){var s=i(this),t=s.find("button"),o="pesapress-setup-loader";return pesapress.helper.loader(o,i(".pesapress-logs-list")),t.attr("disabled","disabled"),i.post(window.ajaxurl,s.serialize()).done(function(e){t.removeAttr("disabled"),i("."+o).remove(),!0===e.success?window.location.href=e.data.url:pesapress.helper.notification.show(e.data,"warning")}).fail(function(e,s,a){i("."+o).remove(),t.removeAttr("disabled"),pesapress.helper.notification.show(pesapress.error,"danger")}),!1}),i("body").on("click",".pesapress-manage-log",function(e){var t=i(this),s=t.attr("data-id"),a=t.attr("data-nonce"),o=i(".log_status").val(),r="pesapress-setup-loader";pesapress.helper.loader(r,i(".pesapress-view-log")),t.attr("disabled","disabled"),i.post(window.ajaxurl,{_wpnonce:a,action:"pesapress_update_log",id:s,status:o}).done(function(e){t.removeAttr("disabled"),i("."+r).remove(),!0===e.success?i("td#"+s).html(o):pesapress.helper.notification.show(e.data,"warning")}).fail(function(e,s,a){i("."+r).remove(),t.removeAttr("disabled"),pesapress.helper.notification.show(pesapress.error,"danger")})})}),jQuery(function(r){r("body").on("submit",".pesapress-general-setting-form",function(e){var s=r(this),t=s.find("button"),o="settings-form-loader";return pesapress.helper.loader(o,s),t.attr("disabled","disabled"),pesapress.helper.notification.reset(),r.post(window.ajaxurl,s.serialize()).done(function(e){t.removeAttr("disabled"),r("."+o).remove(),!0===e.success?pesapress.helper.notification.show(e.data,"success"):pesapress.helper.notification.show(e.data,"warning")}).fail(function(e,s,a){t.removeAttr("disabled"),r("."+o).remove(),pesapress.helper.notification.show(pesapress.error,"danger")}),!1}),r("body").on("submit",".pesapress-field-setting-form",function(e){var s=r(this),t=s.find("button"),o="settings-form-loader";return pesapress.helper.loader(o,s),t.attr("disabled","disabled"),pesapress.helper.notification.reset(),r.post(window.ajaxurl,s.serialize()).done(function(e){t.removeAttr("disabled"),r("."+o).remove(),!0===e.success?pesapress.helper.notification.show(e.data,"success"):pesapress.helper.notification.show(e.data,"warning")}).fail(function(e,s,a){t.removeAttr("disabled"),r("."+o).remove(),pesapress.helper.notification.show(pesapress.error,"danger")}),!1})});